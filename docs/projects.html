<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lukas Galke – projects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Lukas Galke</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./projects.html" rel="" target="" aria-current="page">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./publications.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./talks.html" rel="" target="">
 <span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./bio.html" rel="" target="">
 <span class="menu-text">Bio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#projects" id="toc-projects" class="nav-link active" data-scroll-target="#projects">Projects</a>
  <ul class="collapse">
  <li><a href="#interacting-AIs" id="toc-interacting-AIs" class="nav-link" data-scroll-target="#interacting-AIs">Interacting AIs</a></li>
  <li><a href="#textclf" id="toc-textclf" class="nav-link" data-scroll-target="#textclf">Are We Really Making Progress in Text Classification (textclf)</a></li>
  <li><a href="#LGL" id="toc-LGL" class="nav-link" data-scroll-target="#LGL">Lifelong Graph Representation Learning (LGL)</a></li>
  <li><a href="#phd-project" id="toc-phd-project" class="nav-link" data-scroll-target="#phd-project">Representation Learning for Texts and Graphs</a></li>
  <li><a href="#q-aktiv" id="toc-q-aktiv" class="nav-link" data-scroll-target="#q-aktiv">Analyzing the Scientific, Economic and Societal Impact of Research Activities and Research Networks (Q-AKTIV)</a></li>
  <li><a href="#word2mat" id="toc-word2mat" class="nav-link" data-scroll-target="#word2mat">Word Matrices for Text Representation Learning (word2mat)</a></li>
  <li><a href="#aaerec" id="toc-aaerec" class="nav-link" data-scroll-target="#aaerec">Autoencoders for Document-based Recommendations (aaerec)</a></li>
  <li><a href="#loc-db" id="toc-loc-db" class="nav-link" data-scroll-target="#loc-db">Linked Open Citation Database (LOC-DB)</a></li>
  <li><a href="#vec4ir" id="toc-vec4ir" class="nav-link" data-scroll-target="#vec4ir">Word Embeddings for Information Retrieval (vec4ir)</a></li>
  <li><a href="#training-towards-a-society-of-data-savvy-information-professionals-to-enable-open-leadership-innovation-moving" id="toc-training-towards-a-society-of-data-savvy-information-professionals-to-enable-open-leadership-innovation-moving" class="nav-link" data-scroll-target="#training-towards-a-society-of-data-savvy-information-professionals-to-enable-open-leadership-innovation-moving">TraininG towards a society of data-saVvy inforMation prOfessionals to enable open leadership INnovation (MOVING)</a></li>
  <li><a href="#xlmc" id="toc-xlmc" class="nav-link" data-scroll-target="#xlmc">Extreme Multi-label Text Classification (Quadflor)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="projects" class="level1">
<h1>Projects</h1>
<section id="interacting-AIs" class="level2">
<h2 class="anchored" data-anchor-id="interacting-AIs">Interacting AIs</h2>
<p><em>2022–</em></p>
<p>Imagine you put some artificial neural network agents into a game that can only be solved with communication. How do artificial neural network agents learn to communicate? What communication protocols emerge? What are the parallels to human communication?</p>
<ul>
<li>What makes a language easy to deep-learn? <a href="https://arxiv.org/abs/2302.12239">preprint</a></li>
<li><a href="https://ml4evolang.github.io">Machine learning and the Evolution of Language</a> (two-session workshop at the Joint Conference on Language Evolution)</li>
<li><a href="https://openreview.net/forum?id=rqUGZQ-0XZ5">EmeCom workshop paper at ICLR</a></li>
</ul>
</section>
<section id="textclf" class="level2">
<h2 class="anchored" data-anchor-id="textclf">Are We Really Making Progress in Text Classification (textclf)</h2>
<p><em>2021–</em></p>
<p>Automatically categorizing text documents is a popular research topic with numerous new approaches being published each year. However, do they really give an advantage over earlier approaches? This question has triggered this line of research and the answer we have is worrisome. For instance, many recently proposed methods such as TextGCN are outperformed by a simple multilayer perceptron on a bag-of-words representation – a decade old technique enhanced with today’s best practices.</p>
<ul>
<li><a href="https://arxiv.org/abs/2204.03954">preprint of survey paper</a></li>
<li><a href="https://doi.org/10.18653/v1/2022.acl-long.279">ACL 2022 paper</a></li>
<li><a href="https://github.com/drndr/multilabel-text-clf">code for multi-label classification</a></li>
<li><a href="https://github.com/lgalke/text-clf-baselines">code for single-label classification</a></li>
<li><a href="https://github.com/FKarl/text-classification">extra code for single-label classification with different methods</a></li>
</ul>
</section>
<section id="LGL" class="level2">
<h2 class="anchored" data-anchor-id="LGL">Lifelong Graph Representation Learning (LGL)</h2>
<p><em>2019–</em></p>
<p>Graph neural networks have quickly risen to be the standard technique for machine learning on graph-structured data. Yet graph neural networks are usually only applied to static snapshots of graphs, while real-world graphs (social media, publication networks) are continually evolving. Evolving graphs come with challenges that are rarely reflected in the graph representation learning literature, such as dealing with new classes in node classification. We pursue a lifelong learning approach for graph neural networks on evolving graphs and investigate incremental training, out-of-distribution detection, and issues caused by an imbalanced class distribution.</p>
<ul>
<li>conference paper on out-of-distribution detection in graphs (coming soon)</li>
<li><a href="https://pure.mpg.de/rest/items/item_3368482_4/component/file_3510107/content"><em>Neural Networks</em> journal paper</a></li>
<li><a href="https://doi.org/10.1145/3197026.3197050">IJCNN 2021 conference paper</a></li>
<li><a href="https://rlgm.github.io/papers/21.pdf">ICLR 2019 workshop paper</a></li>
<li><a href="https://github.com/lgalke/lifelong-learning">code</a></li>
<li>related project: <a href="#q-aktiv">Q-AKTIV</a></li>
</ul>
</section>
<section id="phd-project" class="level2">
<h2 class="anchored" data-anchor-id="phd-project">Representation Learning for Texts and Graphs</h2>
<p><em>2017-2022</em></p>
<p>My PhD project. A meta-project bringing together <a href="#word2mat">word2mat</a>, <a href="#textclf">textclf</a>, <a href="#aaerec">aaerec</a>, <a href="#LGL">LGL</a>. <a href="https://doi.org/10.21941/kcss/2023/1">phd thesis</a></p>
</section>
<section id="q-aktiv" class="level2">
<h2 class="anchored" data-anchor-id="q-aktiv">Analyzing the Scientific, Economic and Societal Impact of Research Activities and Research Networks (Q-AKTIV)</h2>
<p><em>2019–2022, funded by the Federal Ministry of Education and Research (BMBF)</em></p>
<p>The aim of Q-AKTIV is to improve the methods for forecasting dynamics and interactions between research, technology development, and innovation. The network analysis methods will be based on recent developments in Deep Learning. In addition to the emergence of new knowledge areas and networks, we focus on the convergence processes of established sectors. The development and evaluation of the new methods initially takes place in the field of life sciences, which is characterized by high marked dynamics. The additional application in economics enables a systematic comparison of the dynamics between the disciplines of science. The new methods will be used to predict the impact of existing research and network structures on the dynamics of knowledge and technologies as well as the future relevance of topics and actors. The result of Q-AKTIV is an implemented and evaluated instrument for the strategic analysis and prognosis of the dynamics in science and innovation. This complements today’s primarily qualitative approaches to early strategic planning and increases the decision-making ability of research institutions, policy makers, and industries. In addition to the analysis of dynamics, also valuable indicators for R &amp; D performance measurement can be derived, e.g., the registration of patents based on scientific publications, the economic development of the companies involved, as well as the outreach of research activities. The practice partner brings in the necessary experience in the field of business valuation and strategy development and ensures a practical testing of the toolkit.</p>
<ul>
<li><em>two more journal papers currently under review</em></li>
<li><a href="https://www.universitaetsverlagwebler.de/_files/ugd/7bac3c_24fe9adc2e3740178ad5ba98f66d1931.pdf">journal paper (German)</a></li>
<li><a href="https://doi.org/10.5281/zenodo.5531084">COVID-19++ dataset</a></li>
<li><a href="https://doi.org/10.1109/BigData52589.2021.9671730">dataset paper</a>.</li>
<li><a href="https://doi.org/10.18420/inf2019_26">paper on learning concept representations</a></li>
<li><a href="https://doi.org/10.1111/jpim.12572">follow-up work building on concept representation learning methods</a></li>
<li><a href="https://gitlab.com/Q-Aktiv/qgraph">Python package for learning concept representations and analyzing network dynamics</a></li>
<li><a href="https://ceur-ws.org/Vol-2773/paper-09.pdf">paper on data enrichment 2</a></li>
<li><a href="https://ceur-ws.org/Vol-2451/paper-23.pdf">paper on data enrichment 1</a></li>
<li><a href="https://github.com/Q-AKTIV/covid19-harvesting-tools">tools for harvesting raw data</a></li>
<li><a href="https://q-aktiv.github.io">project website</a></li>
<li><a href="https://www.zbw-mediatalk.eu/de/2019/03/praxisbericht-open-science-diese-tools-foerdern-die-zusammenarbeit/">interview about open science tools for digital collaboration (de)</a></li>
<li><a href="https://www.zbw-mediatalk.eu/en/2019/03/praxisbericht-open-science-diese-tools-foerdern-die-zusammenarbeit/">interview about open science tools for digital collaboration (en)</a></li>
<li><a href="https://www.b-i-t-online.de/neues/5386">press item (German)</a></li>
<li><a href="https://www.zbmed.de/forschen/abgeschlossene-projekte/q-aktiv">press release (ZB MED, German)</a></li>
<li><a href="https://www.wihoforschung.de/wihoforschung/de/bmbf-projektfoerderung/foerderlinien/quantitative-wissenschaftsforschung/q-aktiv/q-aktiv_node.html">funding announcement (German)</a></li>
</ul>
</section>
<section id="word2mat" class="level2">
<h2 class="anchored" data-anchor-id="word2mat">Word Matrices for Text Representation Learning (word2mat)</h2>
<p><em>2017-2022</em></p>
<p>The idea of this project was to embed each word as a matrix as an alternative to vectors used in word embeddings. By using matrix embeddings instead of vector embeddings, we can use matrix multiplication as a composition function to form a representation for phrases and sentences. While word matrices alone did not exceed the performance of word vectors, a combination of word matrices and word vectors turned out to be beneficial. Later, we showed that pre-trained language models can be distilled into such a purely embedding-based model, giving benefits in efficiency while keeping reasonable accuracy.</p>
<ul>
<li><a href="https://openreview.net/pdf?id=H1MgjoR9tQ">ICLR paper on word matrices</a></li>
<li><a href="https://doi.org/10.18420/inf2019_47">extended abstract in the best-of data science track at the INFORMATIK 2019</a></li>
<li><a href="https://doi.org/10.1109/IJCNN55064.2022.9892144">paper on distilling the knowledge from a pre-trained language model into matrix embedding models</a></li>
<li><a href="https://github.com/florianmai/word2mat">code</a></li>
</ul>
</section>
<section id="aaerec" class="level2">
<h2 class="anchored" data-anchor-id="aaerec">Autoencoders for Document-based Recommendations (aaerec)</h2>
<p>The aim of this project was to build a document-level citation recommendation system that could, for example, make users aware of missing references. A specialty of this project compared to other recommender systems is that we do not use any a user data or a user profile but only operate on the contents of the current draft. The main research question was whether models could be enhanced by using textual side information, such as the title of the draft, which we could confirm for a wide range of autoencoder-based recommendation models.</p>
<p><em>2017–2022</em></p>
<ul>
<li><a href="https://doi.org/10.1007/s10791-022-09408-9">journal paper on citation recommendation</a></li>
<li><a href="https://dl.acm.org/doi/abs/10.1145/3209219.3209236">conference paper on citation recommendation</a></li>
<li><a href="https://doi.org/10.1145/3267471.3267476">RecSys challenge paper on music recommendation</a></li>
<li><a href="https://github.com/lgalke/aae-recommender">code</a></li>
</ul>
</section>
<section id="loc-db" class="level2">
<h2 class="anchored" data-anchor-id="loc-db">Linked Open Citation Database (LOC-DB)</h2>
<p><em>2017–2020, funded by Deutsche Forschungsgemeinschaft (DFG)</em></p>
<p>The LOC-DB project will develop ready-to-use tools and processes based on the linked-data technology that make it possible for a single library to meaningfully contribute to an open, distributed infrastructure for the cataloguing of citations. The project aims to prove that, by widely automating cataloguing processes, it is possible to add a substantial benefit to academic search tools by regularly capturing citation relations. These data will be made available in the semantic web to make future reuse possible. Moreover, we document effort, number and quality of the data in a well-founded cost-benefit analysis. The project will use well-known methods of information extraction and adapt them to work for arbitrary layouts of reference lists in electronic and print media. The obtained raw data will be aligned and linked with existing metadata sources. Moreover, it will be shown how these data can be integrated in library catalogues. The system will be deployable to use productively by a single library, but in principle it will also be scalable for using it in a network.</p>
<ul>
<li><a href="https://dl.acm.org/doi/abs/10.1145/3209219.3209236">conference paper on citation recommendation</a></li>
<li><a href="https://dl.acm.org/doi/abs/10.1145/3197026.3197050">main paper on the project as a whole</a></li>
<li><a href="https://locdb.bib.uni-mannheim.de/demo-frontend/frontpage">demo of the LOC-DB project outcome</a></li>
<li><a href="https://github.com/locdb">collection of code for the LOC-DB project</a></li>
<li><a href="https://locdb.bib.uni-mannheim.de/blog/en/workshop-2018-2/">Second Linked Open Citation Database (LOC-DB) workshop</a></li>
<li><a href="https://locdb.bib.uni-mannheim.de/blog/en/workshop-2/">First Linked Open Citation Database (LOC-DB) Workshop</a></li>
<li><a href="https://locdb.bib.uni-mannheim.de/blog/en/">project website</a></li>
</ul>
</section>
<section id="vec4ir" class="level2">
<h2 class="anchored" data-anchor-id="vec4ir">Word Embeddings for Information Retrieval (vec4ir)</h2>
<p><em>2016–2017</em></p>
<p>The key idea was to use word embeddings for similarity scoring in information retrieval. The two main take-aways:</p>
<ol type="1">
<li>It is important to retain the crisp matching operation (before similarity scoring), even when using word embeddings.</li>
<li>A combination of classic information retrieval method TF-IDF and word embeddings led to the best results.</li>
</ol>
<ul>
<li><a href="https://doi.org/10.18420/in2017_215">paper</a></li>
<li><a href="./pdf/MSc-thesis_LG.pdf">MSc thesis</a></li>
<li><a href="https://github.com/lgalke/vec4ir">code (&gt;200 stars, &gt;40 forks)</a></li>
</ul>
</section>
<section id="training-towards-a-society-of-data-savvy-information-professionals-to-enable-open-leadership-innovation-moving" class="level2">
<h2 class="anchored" data-anchor-id="training-towards-a-society-of-data-savvy-information-professionals-to-enable-open-leadership-innovation-moving">TraininG towards a society of data-saVvy inforMation prOfessionals to enable open leadership INnovation (MOVING)</h2>
<p><em>2016–2019, EU funding, Grant Agreement Number 693092</em></p>
<p>I engaged in this EU Horizon 2020 project as a student worker between 2016 and 2017, leading to contributions to the deliverables 3.1, 3.2 and 3.3, as well as various conference and workshop papers:</p>
<ul>
<li><a href="http://moving-project.eu/wp-content/uploads/2019/03/moving_d3.3_v1.0.pdf">Deliverable 3.3</a></li>
<li><a href="http://moving-project.eu/wp-content/uploads/2018/03/moving_d3.2_v1.0.pdf">Deliverable 3.2</a></li>
<li><a href="http://moving-project.eu/wp-content/uploads/2017/04/moving_d3.1_v1.0.pdf">Deliverable 3.1</a></li>
<li><a href="https://doi.org/10.1007/978-3-030-04257-8_30">ICADL 2018 paper on information retrieval on titles vs.&nbsp;full-text</a></li>
<li><a href="https://doi.org/10.1007/978-3-319-99133-7_18">DEXA 2018 workshop paper on response suggestion</a></li>
<li><a href="https://github.com/lgalke/resuggest">code for response suggestion</a></li>
</ul>
</section>
<section id="xlmc" class="level2">
<h2 class="anchored" data-anchor-id="xlmc">Extreme Multi-label Text Classification (Quadflor)</h2>
<p><em>2015–2018</em></p>
<p>This project originated from my Master’s project (2015–2016), where we developed a pipeline for extreme (=many possible classes) multi-label text classification. We found that a multi-layer perceptron beats the state-of-the-art kNN approach by more than 30%. Moreover, we compared using either the full-text or only the title of a research paper as a basis for classification. The result was that the full-text is only marginally better than the title. My team member Florian Mai investigated the trade-off between full-text and title in his Master’s thesis, finding that the increased availability of title data compensates for increased information in full-text articles.</p>
<ul>
<li><a href="https://github.com/quadflor/Quadflor">code</a> (bought by <a href="https://zbw.eu">ZBW</a> for production usage)</li>
<li><a href="https://doi.org/10.1145/3148011.3148039">K-CAP 2017 paper</a> (outcome of the Master’s project)</li>
<li><a href="https://doi.org/10.1145/3197026.3197039">JCDL 2018 paper</a> (outcome of Florian’s Master’s thesis)</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>